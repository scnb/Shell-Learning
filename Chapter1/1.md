# 第一章Shell入门基础

## 1.什么是Shell？
### 在UNXI及Linux中，shell就是套在内核外面的一层壳。
### Shell又称命令解释器，它能识别用户输入的各种命令，并传递给操作系统。
### 在UNIX或者Linux中，Shell既是用户交互的界面，又是控制系统的脚本语言。
### 目前用的最多的shell：bash（Bourne-Again Shell）

## 2.使用Shell
Shell脚本程序有两种执行方式：
* 用户依次输入一系列的命令，交互式的执行他们
* 用户把这些命令按照顺序保存在一个文件中，然后将该文件作为一个程序来执行
### 1.交互式程序
直接在命令行中敲入程序，输入完一行后，按一次回车
### 2.创建脚本
对于一组需要经常重复执行的Shell语句来说，将他们保存在一个文件中来执行是一种非常明智的做法。

通常我们将这种包含多个Shell语句的文件成为**Shell脚本**

Shell程序中的注释以 “#”符号开始，一直持续到该行的结束。

一般第一行以 "#! /bin/sh"开始，"#!"字符告诉系统同一行中紧跟在它后面的那个参数是用来执行文件的程序。

另外需要注意的是，在创建玩Shell脚本之后，用户并没有执行权限，因此要使用如下命令添加执行权限：

    chmod u+x filename.sh
    chmod 7xx filename.sh

其中u代表user即当前用户，x代表执行权限，+代表增加权限，而-代表去掉权限。

## 3.向脚本传递参数
### 许多情况下，Shell脚本需要接受用户的输入，根据用户输入的参数来执行不同的操作。

### 从命令行传递给Shell脚本的参数又成为位置参数，主要是因为Shell脚本会根据参数的位置来接受它们的值。

### 一些系统变量
* $n 表示传递给脚本的第n个参数，如$1表示第一个参数
* $# 命令行参数的个数
* $0 当前脚本的名称
* $* 以"参数1 参数2 参数3……"的形式返回所有参数的值
* $@ 以"参数1" "参数2" "参数3" ……的形式返回所有参数的值
* $_ 保存之前执行的命令的最后一个参数

## 4.第一个Shell程序：Hello，Bash Shell！

    #! /bin/bash
    # 输出字符串
    echo "Hello, Bash Shell!"

### 对于一个基本的Shell程序来说，应该拥有一下基本元素：
* #! /bin/bash
* 注释：说明某些代码的功能
* 可执行语句：实现程序的功能

### #! /bin/bash 的功能——**指定命令解释器**
在Linux中，通常会同时安装多个Shell程序，例如sh、bash或者csh等。

"#!标识，表示当前的程序指定了解释并执行它的Shell，尝试读取#！后面的内容，搜寻解释器的绝对路径，如果发现了指定的解释器，就会创建一个关于该解释器的进程。

Shell脚本的这个规定使得用户可以非常灵活的调用任何解释器，而且不仅仅限于**Shell程序**

例如调用PHP的解释器：

    #! /usr/local/php5/bin/php

除此之外，用户还可以指定一些其他命令，例如more或者cat来显示当前程序的代码：

    #! /bin/more
    #! /bin/cat

从本质上讲，该标识的作用就是指定解释当前脚本文件的程序。

Shell脚本中的注释风格
-----------------------------------------

### 传统的Shell只支持单行注释，表示方式是一个"#"，从该符号开始一直到行尾都属于注释的内容。

例如：

    #注释内容
    或多行注释：
    #注释1
    #注释2
    #注释3

用户可以通过一些变通的方法来实现多行注释：

最简单的办法就是使用冒号":"配合here document，语法如下：

    :<<BLOCK
    ……注释内容
    BLOCK

一个here document就是一段带有特殊目的的代码段，它使用I/O重定向的形式将一个命令序列传递到一个交互程序或者命令中。

在上面的代码中是将BLOCK中的代码重定向到一个不存在的命令，从而间接的实现了多行注释。

如何执行Shell程序
---------------------------------------------

在Linux中，如果要执行某个Shell程序，用户可以通过3中方式来实现：

1. 授予用户执行该脚本文件的权限，使得该程序能够直接执行
2. 通过调用Shell脚本解释器来执行
3. 通过source命令来执行

方法1：直接在脚本中指定解释器，当前的Shell会自动调用指定的解释器。

方法2：用户首先调用的是解释器，然后由解释器解释脚本文件。

第一种方法和第二种方法本质上是相同的。

方法3：source是Shell内部的一个命令，功能是读取指定的Shell文件，并依次执行其中的所有语句。并且在当前的Shell里执行，没有创建新的子Shell进程。

例子如下：

    ./ex1-1.sh
    /bin/bash/ ex1-1.sh
    source ex1-1.sh

Shell程序的退出状态
--------------------------------------
在UNIX或Linux中，每个命令都会返回一个退出状态码。

退出状态码是一个整数，范围为0-255。

通常情况下，成功的命令返回0，不成功的命令返回非0值。

非0值被解释为一个错误码。

Shell脚本中的函数和**脚本本身**也会返回退出状态码。
另外，用户也可在脚本中使用exit语句将指定的退出状态码传递给Shell。

当没有通过exit语句退出程序时，整个程序的退出状态码由最后执行的那一条语句来决定。

例如：

    #! /bin/bash
    statement1
    ……
    #将由最后的命令来决定退出状态码
    statement_last

另外，在Shell中系统变量$?保存了最后一条命令的退出状态，因此上面的程序等价于：

    #! /bin/bash
    statement1
    ……
    statement_last
    echo $?  (或者可以直接输出echo)

